%% isodoc-style.sty -- LaTeX2e isodoc style
%
% Copyright (C) 2009-2016 Fabrice Niessen

%* Identification

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{isodoc-style}[2016/12/13 v1.1 Style file for isodoc]

%* TODO

% - Zipped city is not aligned correctly.
% - Bullets (itemize) are not nice, but that's the default style.
% - Too much space between opening and first line of first paragraph (opening
%   is closer to the letter's object, which makes the opening somehow
%   disappear)
% - The hrules should be in the same color as the text above them.
% - We should be able to remove labels when no text below is empty for fields:
%   Your letter of, Your ref, Our ref.
% - Left mark should really be at left (no space) and in a customizable color.
% - Check why the 2 options are typeout in the log.
% - Add option AnciensdeBurnot.

%* Font package

\usepackage{bookman}

%* Colors

\usepackage{xcolor}
\definecolor{isofni@theme}{HTML}{ED9C00}
\definecolor{isofni@lightblue}{HTML}{1A69BA}
\definecolor{isofni@darkblue}{HTML}{003399}

\definecolor{isofni@logosymbol}{named}{darkgray}
\definecolor{isofni@returnaddr}{named}{darkgray}
\definecolor{isofni@hft}{named}{darkgray}

%* Options

% The options you can set are:
%
%   - scorpios
%   - mygooglest

%** mygooglest

\DeclareOption{mygooglest}{%
    \typeout{Saw option `mygooglest'.}

    \def\ISOCompany       {}
    \def\ISOReturnAddress {\color{isofni@returnaddr}\mdseries{}\tiny{}Expéditeur~: Fabrice Niessen \\ Henri Regastraat, 3 \\ B-3000 Leuven}
    \def\ISOWebSite       {www.mygooglest.com/fni}
    \def\ISOEmail         {\href{mailto:fni@mygooglest.com}{fni@mygooglest.com}}

    % redefine logo
    \renewcommand{\logo}{
    \begin{textblock}{140}(35,20)
      %% \noindent
      \begin{tabular}{@{}cl}
        {\color{isofni@logosymbol}\LetterSymbol} & \who\\
        & \street\\
        & \zippedcity\\
        %% \ifforeign\\& \country\fi\\
        {\color{isofni@logosymbol}\EmailSymbol} & \email\\
        {\color{isofni@logosymbol}\MobileSymbol} & \lead\cellphone
      \end{tabular}
    \end{textblock}}}

%** scorpios

\DeclareOption{scorpios}{%
    \typeout{Saw option `scorpios'.}

    \def\ISOCompany       {Scorpios Côte d'Azur}
    \def\ISOReturnAddress {\color{isofni@returnaddr}\mdseries{}\tiny{}Expéditeur~: Fabrice Niessen \\ Henri Regastraat, 3 \\ B-3000 Leuven}
    \def\ISOWebSite       {www.scorpioscotedazur.com}
    \def\ISOEmail
    {\href{mailto:location@scorpioscotedazur.com}{\textcolor{blue}{location@}{\bfseries\textcolor{isofni@theme}{scorpios}\textcolor{black}{cotedazur}\textcolor{isofni@theme}{.com}}}}

    % redefine logo
    \renewcommand{\logo}{
    \begin{textblock}{140}(10,13)
        \includegraphics[width=2cm]{scorpios-logo-big}
    \end{textblock}
    \begin{textblock}{140}(35,13)
        \noindent
        {\bfseries{}%
        {\sffamily{}%
        {\Large\textcolor{isofni@logosymbol}{SCORPIOS}}\\
        \\[-0.3cm]%
        CÔTE d'AZUR}}\\
        \\[-0.1cm]%
        \scriptsize{
        \noindent%
        % \begin{minipage}[t]{1.0\linewidth}
        %     {\sffamily\color{isofni@logosymbol}\LetterSymbol}~\who\\
        %     \hspace{1cm}\street\\
        %     \hspace{0.5cm}\zippedcity\\
        % %     & \ifforeign\\\country\fi\\
        % \end{minipage}\\
        \begin{tabular}{@{}cl}
            {\sffamily\color{isofni@logosymbol}\LetterSymbol} & \who\\
            & \street\\
            & \zippedcity\\
            % & \ifforeign\\\country\fi\\
            {\sffamily\color{isofni@logosymbol}{\EmailSymbol}} & \email\\
            {\sffamily\color{isofni@logosymbol}\MobileSymbol} & \lead\cellphone
        \end{tabular}
        % \begin{align}
        %     & \LetterSymbol & \who\\
        %     & \MobileSymbol & \lead\cellphone
        % \end{align}
        }
    \end{textblock}}}

% default options are processed
\ExecuteOptions{mygooglest}

% given options are processed, possibly overriding the defaults
\ProcessOptions

%* General options

\setupdocument{%
%** 1. General options
    % fontpackage = fnihandwriting,
    % fontpackage = times,
    language=fr-FR,
%
%** 2. Logo
    company = {\ISOCompany},
    who = Fabrice Niessen,
    street = {Henri Regastraat, 3},
    zip = 3000,
    city = Leuven,
    country = Belgique,
    countrycode = B-,
%
%** 3. Address window
    rightaddress,
    noreturn,
    returnaddress = {\ISOReturnAddress},
    to = {nom du destinataire\\
          adresse\\
          suite\\
          etc
         },
%
%** 4. Page footer
    nofooter,
    areacode = 32,
    cellphone = 477-95.73.36,
    % website = {\ISOWebSite},
    email = {\ISOEmail},
%
%** 5. Folding mark
    foldleft,
    fold3,
%
%** 6. Header fields
    date = today,
    opening = {Chère Madame, Cher Monsieur},
%
%** 7. Closing, autograph, signature
    closing = {Veuillez recevoir, Madame, Monsieur, mes salutations les plus
               sincères},
    autograph=2,
    signature = F.~Niessen,% XXX check in Wybo's file
%
%** 8. Invoice specific data
    iban = {BE15 9799 9740 5030},
    bic = ARSPBE22,
}

\autograph{2}
    {24mm}% height of the image
    {0}% vertical position from the closing
    {72}% vertical position of the name
    {0}% distance in the margin
    {signature-F-Niessen}

%* Extra goodies

% redefine headings (except for the first page)
\def\@hft{\color{isofni@hft}\mdseries{}\tiny{}\sffamily}
\fancyhead[L]{}
\fancyhead[R]{\@hft\date}
\renewcommand{\headrulewidth}{0.0pt}
\fancyfoot[L]{}
\fancyfoot[R]{\@hft\thepage/\pageref{LastPageOf\thelettercount}}


% % redefine folding mark
% \AtBeginDocument{%
%     \begin{textblock*}{3mm}(195mm,\yfold)%
%         {\color{isofni@logosymbol}\rule{\hsize}{.2pt}}
%     \end{textblock*}}


% paragraph layout with zero `\parindent' and *non-zero* `\parskip'
\RequirePackage{parskip}

%% % set space between lines
%% \RequirePackage{setspace}
%% \setstretch{1.2}

% hyperref
\hypersetup{
    breaklinks=true,% allow hyperlinks to wrap over lines
    colorlinks=true,% avoid the red boxed around cross-references
    linkcolor=isofni@hft,% color of internal links
    citecolor=isofni@hft,% color of links to bibliography
    filecolor=isofni@lightblue,% color of file links
    urlcolor=isofni@lightblue, % color of external links
}

\endinput

% This is for the sake of Emacs.
% Local Variables:
% coding: utf-8
% ispell-local-dictionary: "american"
% time-stamp-format: "%:y/%02m/%02d"
% time-stamp-start: "Provides\\(Class\\|Package\\){[a-zA-Z-]+}\\["
% time-stamp-end: " "
% End:

%% isodoc-style.sty ends here
